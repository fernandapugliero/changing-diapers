<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fix My Diaper: Baby-Friendly Places with Changing Tables</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß∑</text></svg>">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Navega√ß√£o -->
  <nav>
    <a href="index.html">Map</a>
    <a href="list.html">List</a>
    <a href="submit.html">Submit</a>
  </nav>

  <h1>Need to change a diaper?</h1>
  <h2>Find baby-friendly places in your city with changing tables ‚Äì cafes, restaurants, and more.</h2>

  <!-- Mapa (Aqui ele vai ser centralizado na posi√ß√£o do usu√°rio ou no fallback) -->
  <div id="map" style="height: 70vh;"></div>

  <footer>
    Made with ‚ô•Ô∏è in Berlin<br />
    Created by <a href="https://sites.google.com/view/fernandapugliero" target="_blank">Fernanda Pugliero</a><br /><br />
    <a href="about.html">About</a> | 
    <a href="legal.html">Legal</a> | 
    <a href="submit.html">Submit a Location</a>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
  <script>
    // Define uma localiza√ß√£o padr√£o (fallback), no caso, no centro de Berlim
    var defaultLat = 52.5200;  // Latitude de Berlim
    var defaultLon = 13.4050;  // Longitude de Berlim

    // Verifica se o navegador suporta geolocaliza√ß√£o
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        var userLat = position.coords.latitude;  // Latitude do usu√°rio
        var userLon = position.coords.longitude; // Longitude do usu√°rio
        
        // Cria o mapa centralizado na localiza√ß√£o do usu√°rio
        var map = L.map('map').setView([userLat, userLon], 13);  

        // Adiciona o tile layer (camada do mapa)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Adiciona um marcador na localiza√ß√£o do usu√°rio
        L.marker([userLat, userLon]).addTo(map)
          .bindPopup('You are here')
          .openPopup();
        
      }, function() {
        // Se o usu√°rio n√£o permitir ou se houver um erro, usamos o fallback
        createMapWithFallback();
      });
    } else {
      // Se o navegador n√£o suporta geolocaliza√ß√£o, usamos o fallback
      createMapWithFallback();
    }

    // Fun√ß√£o para criar o mapa com a localiza√ß√£o padr√£o (fallback)
    function createMapWithFallback() {
      var map = L.map('map').setView([defaultLat, defaultLon], 13);  // Centraliza no ponto padr√£o (Berlim)

      // Adiciona o tile layer (camada do mapa)
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
      }).addTo(map);

      // Adiciona um marcador na localiza√ß√£o padr√£o
      L.marker([defaultLat, defaultLon]).addTo(map)
        .bindPopup('Default location (Berlin)')
        .openPopup();
    }
  </script>
</body>
</html>
